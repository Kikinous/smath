% This is part of Un soupçon de mathématique sans être agressif pour autant
% Copyright (c) 2012
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Épreuve de Bernoulli}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Source : \cite{YDRqwN}

Nous jouons à pile ou face avec une pièce non truquée. Nous avons donc une chance sur deux d'obtenir pile et une chance sur deux d'obtenir face. Nous sommes intéressé par le nombre de fois que nous obtenons pile en jouant souvent.

\begin{example}
Commençons par jouer deux fois et dessinons un arbre.
            \begin{equation*}
            \xymatrix{%
                &&&\fbox{\text{Début}}\ar[lld]_{\frac{ 1 }{2}}\ar[rrd]^{\frac{ 1 }{2}}\\
                &\fbox{P}\ar[ld]_{\frac{ 1 }{2}}\ar[rd]^{\frac{ 1 }{2}}&&&&\fbox{F}\ar[ld]_{\frac{ 1 }{2}}\ar[rd]^{\frac{ 1 }{2}}\\
                \fbox{PP}&&\fbox{PF}&&\fbox{FP}&&\fbox{FF}
               }
            \end{equation*}

            Quelque questions :
            \begin{enumerate}
                \item
                    Quelle est la probabilité d'avoir deux fois pile ?
                \item
                    Quelle est la probabilité d'obtenir une fois pile et une fois face ?
                \item
                    Quelle est la probabilité d'obtenir au moins un face ?
            \end{enumerate}
            Les réponses :
            \begin{enumerate}
                \item
                    Sur les quatre issues possibles, une seule a deux fois face. La probabilité est \( 1/4\).
                \item
                    Sur les quatre issues possibles, deux ont un pile et un face : \( PF\) et \( FP\). La probabilité de tomber sur l'un des deux est \( 1/2\).
                \item
                    Sur les quatre issues possibles, trois ont au moins un face : \( PF\), \( FP\) et \( FF\). La probabilité d'avoir un des trois est \( 3/4\).
            \end{enumerate}
    
\end{example}


\begin{example}
    Dans une classe de \( 31\) élèves, \( 19\) sont nés en \( 1996\). Si nous en prenons un au hasard, nous avons donc une probabilité environ \( 0.61\) qu'il soit né en \( 1996\). Que penser de cet arbre où l'on note «O»  l'événement «avoir tiré un élève de \( 1996\)» et «N» l'événement contraire ?
   
            \begin{equation*}
            \xymatrix{%
                &&&\fbox{\text{Début}}\ar[lld]_{\frac{ 19 }{31}}\ar[rrd]^{\frac{ 12 }{31}}\\
                &\fbox{O}\ar[ld]_{\frac{ 19 }{31}}\ar[rd]^{\frac{ 12 }{31}}&&&&\fbox{N}\ar[ld]_{\frac{ 19 }{31}}\ar[rd]^{\frac{ 12 }{31}}\\
                \fbox{OO}&&\fbox{ON}&&\fbox{NO}&&\fbox{NN}
               }
            \end{equation*}

    Si il n'y a pas de remise, alors l'arbre devrait ressembler plutôt à ceci :
            \begin{equation*}
            \xymatrix{%
                &&&\fbox{\text{Début}}\ar[lld]_{\frac{ 19 }{31}}\ar[rrd]^{\frac{ 12 }{31}}\\
                &\fbox{O}\ar[ld]_{\frac{ 18 }{30}}\ar[rd]^{\frac{ 12 }{30}}&&&&\fbox{N}\ar[ld]_{\frac{ 19 }{30}}\ar[rd]^{\frac{ 11 }{30}}\\
                \fbox{OO}&&\fbox{ON}&&\fbox{NO}&&\fbox{NN}
               }
            \end{equation*}

\end{example}

\begin{example}
    Supposons que nous jouons au poker avec un paquet de \( 52\) cartes. Si nous avons déjà trois as en main, il reste \( 49\) cartes dans le paquet, et parmi ces \( 49\) cartes, un seul as. Nous avons donc une chance sur \( 49\) de réussir un carré en échangeant une carte.

    Si par contre nous jouons avec des dés, la probabilité de lancer un quatrième as est de une sur six; la différence est énorme.
\end{example}


\begin{definition}
    Toute expérience aléatoire conduisant à deux issues possibles (appelées \emph{échec} ou \emph{succès}) est une \defe{épreuve de Bernoulli}{Bernoulli!épreuve}. Nous noterons \( p\) la probabilité du succès. La probabilité de l'échec sera alors \( 1-p\).
\end{definition}

\begin{example}
    Nous lançons un dé et nous nommons «succès» l'événement «le \( 6\) sort». Cela est une épreuve de Bernoulli avec \( p=1/6\).
\end{example}

\begin{example}
    
    Demandez à un de vos amis si il aime réciter des vers de Corneille en réunion de famille.

    Vous noterez que cela est bien une épreuve de Bernoulli, mais qu'il vous est plus ou moins impossible d'en estimer la probabilité de succès a priori. Au mieux vous pouvez dire «j'espère bien qu'aucun de mes amis n'a ce genre de hobbies».
    
\end{example}

\begin{example}
    Choisissez une voiture au hasard dans une file, et considérer l'événement «le conducteur est en train téléphoner». Ici encore il s'agit d'une épreuve de Bernoulli, mais il n'est pas possible d'en donner la probabilité.
\end{example}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Schéma de Bernoulli}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}
    La répétition de \( n\) épreuves de Bernoulli identiques et indépendants est un \defe{schéma de Bernoulli}{Bernoulli!schéma}.
\end{definition}
Nous allons nous intéresser au nombre de succès d'un schéma de Bernoulli de probabilité \( p\).

Reprenons notre arbre de choix d'élèves en fonction de l'année de naissance.

\begin{equation*}
\xymatrix{%
    &&&\fbox{\text{Début}}\ar[lld]_{\frac{ 19 }{31}}\ar[rrd]^{\frac{ 12 }{31}}\\
    &\fbox{O}\ar[ld]_{\frac{ 19 }{31}}\ar[rd]^{\frac{ 12 }{31}}&&&&\fbox{N}\ar[ld]_{\frac{ 19 }{31}}\ar[rd]^{\frac{ 12 }{31}}\\
    \fbox{OO}&&\fbox{ON}&&\fbox{NO}&&\fbox{NN}
   }
\end{equation*}
Nous notons \( P(X=0)\) la probabilité de tirer zéro élèves nés en \( 1996\); \( P(X=1)\) la probabilité d'en tirer (exactement \( 1\)); \( P(X=2)\) est la probabilité d'en tirer deux. En suivant la logique, \( P(X=3)\) est nul parce que de toutes façons, on n'en tire que deux. Étudions les cas.

Nous commençons par calculer \( P(X=0)\). Pour obtenir aucun étudiant nés en \( 1996\) en en tirant deux, il faut d'abord en tirer un qui n'est pas né en \( 1996\) (probabilité : \( \frac{ 12 }{ 13 }\)) puis en tirer un second (probabilité : \( \frac{ 12 }{ 13 }\) encore). Du coup la probabilité est
\begin{equation}
    P(X=0)=\left( \frac{ 12 }{ 31 } \right)^2,
\end{equation}
c'est à dire environ\footnote{Encore une fois : méfiez vous des approximations numériques. Vous n'accepteriez pas de confier votre vie à un calcul qui a arrondi la seconde décimale d'une probabilité.} \( 0.15\).

Calculons maintenant \( P(X=1)\). Nous repérons dans le tableau les cases qui correspondent à un élève né en \( 1996\) et un élève non né en \( 1996\). Ce sont les cases \( ON\) et \( NO\). En suivant les branches de l'arbre, la probabilité d'obtenir le \( ON\) est 
\begin{equation}
    P(ON)=\frac{ 19 }{ 31 }\times \frac{ 12 }{ 31 },
\end{equation}
tandis que l'autre est
\begin{equation}
    P(NO)=\frac{ 12 }{ 31 }\times \frac{ 19 }{ 31 }.
\end{equation}
Notons que c'est la même. La probabilité totale de pêcher \emph{exactement} un élève de \( 1996\) en en pêchant deux au hasard dans la classe est
\begin{equation}
    P(X=1)=2\times\frac{ 12 }{ 31 }\times \frac{ 19 }{ 31 }=\frac{ 456 }{ 961 },
\end{equation}
qui est environ \( 0.47\). Presque une chance sur deux.

Enfin, calculons la probabilité d'en tirer deux est donnée par la case \( OO\) de l'arbre et sa probabilité est
\begin{equation}
    P(X=2)=\left( \frac{ 19 }{ 31 } \right)^2
\end{equation}
qui est environ \( 0.37\).


\begin{example}
Nous effectuons \( 50\) lancers de pile ou face et nous comptons le nombre de réussite.

Par exemple :\\
P F P P P P F F F F F F F P P P P P F P F F P P F F F F F F P P F F F F P F F F F P P P P F F F F P \\
 total : 29 F et  21 P
 
Un autre exemple :

F F P P P P F P P P F P P P F F F F F P F F P P P P P F F F P P P F F P F F F P F P P P F P F P P F \\
 total : 23 F et  27 P

 Intuitivement, nous imaginons que nous devrions toujours obtenir autour de \( 25\) piles et \( 25\) faces.
    
\end{example}

\begin{example}

Effectuons dix mille fois les cent lancers et traçons un diagramme en bâtons décrivant le nombre de fois que nous avons obtenu chaque quantité de «piles».

Les diagrammes en bâtons de la figure \ref{LabelFigSimulBinNWxfTN} % From file SimulBinNWxfTN
représentent, en fonction de \( k\), le nombre de fois qu'on a obtenu exactement \( k\) fois pile en jouant \( 10\), \( 100\) et \( 10000\) fois à pile ou face.
\newcommand{\CaptionFigSimulBinNWxfTN}{Jouer à pile ou face un certain nombre de fois, et s'intéresser au nombre de fois que le «pile» sort.}
\input{Fig_SimulBinNWxfTN.pstricks}

%See also the subfigure \ref{LabelFigSimulBinNWxfTNssLabelSubFigSimulBinNWxfTN0}
%See also the subfigure \ref{LabelFigSimulBinNWxfTNssLabelSubFigSimulBinNWxfTN1}
%See also the subfigure \ref{LabelFigSimulBinNWxfTNssLabelSubFigSimulBinNWxfTN2}
%See also the subfigure \ref{LabelFigSimulBinNWxfTNssLabelSubFigSimulBinNWxfTN3}

Quelque propriétés intuitives.
\begin{enumerate}
    \item
        Il y a un maximum sur \( 50\) parce que lorsqu'on tire \( 100\) fois une pièce, on a un maximum de chances d'avoir \( 50\) fois pile et \( 50\) fois face.
    \item
        Le dessin doit être symétrique. Il y a a priori autant de chances d'avoir \( 48\) faces et \( 52\) pile que le contraire.
    \item
        La courbe doit valoir à peu près zéro pour les petits et les grands nombres : nous sommes d'accord que la probabilité d'obtenir \( 95\) fois face sur \( 100\) lancers est à peu près le vide interstellaire.
\end{enumerate}
    
\end{example}

\newpage
\begin{example}
    Nous jouons au poker avec des dés. Un dé a \( 6\) face : as, roi, dame, valet, \( 10\), \( 9\). Nous voulons obtenir une paire de valet en lançant trois dés (nous estimons qu'un brelan de valet est une réussite). Voici l'arbre.

    \begin{equation}
    \xymatrix{%
        o&o&o&\boxed{VVV}\\
        o&o&\boxed{VV}\ar[ur]^{\frac{1}{ 6 }}\ar[rd]_{\frac{ 5 }{ 6 }}\\
        o&o&o&\boxed{VV \bar V}\\
        o&\boxed{V}\ar[uur]^{\frac{1}{ 6 }}\ar[ddr]_{\frac{ 5 }{ 6 }}\\
        o&o&o&\boxed{V \bar V  V}\\
        o&o&\boxed{V \bar V}\ar[ur]^{\frac{1}{ 6 }}\ar[dr]_{\frac{ 5 }{ 6 }}\\
        o&o&o&\boxed{V \bar V\bar V}\\
        \boxed{\text{Début}}\ar[ruuuu]^{\frac{1}{ 6 }}\ar[rdddd]_{\frac{ 5 }{ 6 }}\\
        o&o&o&\boxed{\bar  V V V}\\
        o&o&\boxed{ \bar V V}\ar[ur]^{\frac{1}{ 6 }}\ar[dr]_{\frac{ 5 }{ 6 }}\\
        o&o&o&\boxed{ \bar V \bar V V}\\
        o&\boxed{ \bar V}\ar[uur]^{\frac{1}{ 6 }}\ar[ddr]_{\frac{ 5 }{ 6 }}\\
        o&o&o&\boxed{ \bar V \bar V V}\\
        o&o&\boxed{\bar V\bar V}\ar[ur]^{\frac{1}{ 6 }}\ar[dr]_{\frac{ 5 }{ 6 }}\\
        o&o&o&\boxed{ \bar V \bar V  \bar V}\\
       }
    \end{equation}

            %\begin{equation*}
            %\xymatrix{%
            %    o&o&o&o&o&o&o&\fbox{\text{Début}}\ar[lllld]_{\frac{ 1 }{6}}\ar[rrrrd]^{\frac{ 5 }{6}}\\
            %    o&o&o&\fbox{A}\ar[lld]_{\frac{ 1 }{ 6 }}\ar[rrd]^{\frac{ 5 }{ 6 }}&o&o&o&o&o&o&\fbox{B}\ar[lld]_{\frac{ 1 }{ 6 }}\ar[rrd]^{\frac{ 5 }{ 6 }}&o&o&o\\
            %    o&\fbox{C}\ar[ld]_{\frac{ 5 }{ 6 }}\ar[rd]^{\frac{ 1 }{ 6 }}&o&o&o&\fbox{D}\ar[ld]_{\frac{ 5 }{ 6 }}\ar[rd]^{\frac{ 1 }{ 6 }}&o&o&o&\fbox{E}&o&o&o&\fbox{F}\ar[ld]_{\frac{ 5 }{ 6 }}\ar[rd]^{\frac{ 1 }{ 6 }}&o\\
            %    \fbox{F}&o&\fbox{F}&o&\fbox{F}&o&\fbox{F}&o&\fbox{F}&o&\fbox{F}&o&\fbox{F}&o&\fbox{F}
            %   }
            %\end{equation*}
    
\end{example}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Simuler un schéma de Bernoulli avec un ordinateur}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Pour simuler une expérience de Bernoulli de probabilité \( p\), il suffit de prendre un nombre aléatoire entre \( 0\) et \( 1\) puis de vérifier si il est plus petit que \( p\).

En effet, si nous prenons un nombre au hasard entre \( 0\) et \( 1\), quelle est la probabilité qu'il soit plus petit que, par exemple, \( 0.8\) ?

La majorité des tableurs comme \wikipedia{fr}{Libreoffice} ou OOO possèdent des fonctions toutes faites pour simuler.

Par exemple ceci écrit «succès» avec une probabilité \( 0.6\).
\lstinputlisting{ex_random_binomiale.py}

Le programme suivant a produit les résultats et graphiques présentés plus haut.
\lstinputlisting{simul_Bernoulli.py}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Exercices }
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\Exo{Premiere-0071}
\Exo{Premiere-0074}
\Exo{Premiere-0075}
\Exo{Premiere-0076}
\Exo{Premiere-0077}
\Exo{Premiere-0078}


