% This is part of Un soupçon de mathématique sans être agressif pour autant
% Copyright (c) 2012
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

\chapter{Structures de base}

\begin{remark}
    Certains bouts de codes donnés ici commencent par la ligne
    \begin{quote}
        \info{\# -*- coding: utf8 -*-}
    \end{quote}
    Si vous savez ce que signifie «\wikipedia{fr}{Utf8}{utf8}», vous devriez deviner à quoi sert cette ligne. Sinon c'est pas grave : vous n'êtes pas \emph{obligés} de l'écrire dans vos programmes, mais c'est une bonne habitude à prendre. Nous en reparlerons peut-être plus tard.
\end{remark}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{La fonction \info{print}}
%---------------------------------------------------------------------------------------------------------------------------

Python ne prend pas d'initiatives. Si vous ne lui demandez pas d'écrire quelque chose, il n'écrira rien. La commande la plus courante\footnote{Bien entendu, python permet de programmer des fenêtres, des boutons et autres boites de dialogue, auquel cas ce ne sera plus la commande \info{print} qui jouera.} pour afficher quelque chose à l'écran est la commande \info{print}. 
\begin{enumerate}
    \item
        Pour afficher la valeur d'une variable \info{a}, mettre \info{print(a)}.
    \item
        Pour afficher un texte (par exemple «bonjour» ), mettre des guillemets : \info{print(``bonjour'')}.
\end{enumerate}
Si vous voulez afficher plusieurs choses, vous les séparez par une virgule.

\lstinputlisting{ex_print.py}

donne

\lstinputlisting[title=Résultat]{res_ex_print.txt}

Notez que les lignes qui commencent par \# ne sont pas prises en compte. Cela permet au programmeur de mettre des notes pour lui-même. N'hésitez pas à en mettre pour rendre votre code plus lisible.

\Exo{Premiere-0037}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Listes}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Une liste est une collection ordonnée d'éléments. Elle se définit avec des crochets.

\lstinputlisting{ex_listes.py}

donne

\lstinputlisting[title=Résultat]{res_ex_listes.txt}

Nous pouvons ajouter un élément à une liste en utilisant la \emph{méthode} \info{append}, et retrouver un élément d'une liste par son numéro (attention : python numérote à partie de zéro), en demandant par exemple \info{A[4]} pour l'élément numéro \( 4\) de la liste \info{A}. Cela sera donc le cinquième élément de la liste. Cas spécial : le dernier élément de la liste est le numéro \( -1\).

\lstinputlisting{ex_listes2.py}

donne

\lstinputlisting[title=Résultat]{res_ex_listes2.txt}


\Exo{Premiere-0033}


La multiplication d'une liste par un nombre donne la liste contenant plusieurs fois la liste originale. Nous ajoutons une liste à une autre en utilisant la méthode \info{extend}.


\lstinputlisting{ex_listes3.py}

donne

\lstinputlisting[title=Résultat]{res_ex_listes3.txt}


\Exo{Premiere-0034}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Quelque mots à propos des fonctions}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Choses Basiques}
%---------------------------------------------------------------------------------------------------------------------------

Si un calcul doit être refait plusieurs fois dans un même programme, il est bon d'écrire une fonction qui sera appelée à chaque fois. En python, une fonction se déclare avec le mot-clef \info{def} comme ceci :
\begin{quote}
    \info{def\ nom\_de\_ma\_fonction(a,b):}
\end{quote}
où \info{a} et \info{b} seront les arguments de la fonction. Il peut y en avoir un seul, deux, ou plus (pas de limites), ou pas du tout. Une fonction peut afficher et calculer autant de résultats intermédiaires que l'on veut. 

\lstinputlisting{ex_fonction.py}

donne

\lstinputlisting[title=Résultat]{res_ex_fonction.txt}

Cette fonction ne fait qu'afficher du texte, mais ne retourne pas de valeurs. Voici une fonction qui retourne \( 1\) si le nombre donné est plus grand ou égal à zéro et retourne \( -1\) si il est négatif.


\lstinputlisting{ex_fonction2.py}

donne

\lstinputlisting[title=Résultat]{res_ex_fonction2.txt}


\Exo{Premiere-0066}


\Exo{Premiere-0068}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Pour aller plus loin}
%---------------------------------------------------------------------------------------------------------------------------

La fonction de l'exemple précédent peut être simplifiée en sachant que dès que une instruction \info{return} est rencontrée, l'exécution de la fonction est \emph{immédiatement} stoppée et la valeur est retournée. Nous pouvons donc écrire

\lstinputlisting{ex_fonction3.py}

Si le nombre donné est positif, un \info{return} est rencontré à l'intérieur du \info{if}, et l'autre \info{return} n'est jamais rencontré.

D'autre part, une fonction peut vraiment prendre \emph{n'importe quoi} comme argument, y compris des autres fonctions. Dans l'exemple suivant, la fonction \info{evaluation} prend un argument une fonction et un nombre, et retourne la fonction évaluée en ce nombre.

\lstinputlisting{ex_fonction4.py}

donne

\lstinputlisting[title=Résultat]{res_ex_fonction4.txt}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Tester la divisibilité}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Nous aurons de temps en temps besoin de tester si un nombre est divisible par deux, par trois ou par autre chose.

Testez le programme suivant.

\lstinputlisting{ex_division.py}

Est-ce que vous pouvez en déduire un critère de divisibilité basé sur l'usage de la «division entière» \info{\%} ? Regardez combien vaut \info{i\%4} pour les \info{i} qui sont divisible par \( 4\).

\Exo{Premiere-0067}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Moyenne, médiane, quartiles}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\label{SecZYftar}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Moyenne}
%---------------------------------------------------------------------------------------------------------------------------

\begin{example}     \label{ExerfDMnv}
    % Note : la liste ci-dessous est codée en dur dans les scripts d'exemples. Si on la modifie, il faut modifier les scripts.
    Un magasin de chaussures a vendu des tailles entre \( 40\) et \( 45\) suivant la distribution suivante :
    \begin{center}
        \begin{tabular}{|l||c|c|c|c|c|c|}
            \hline
            taille \( x_i\)&40&41&42&43&44&45\\
            \hline
            effectifs \( n_i\)&3&5&10&8&2&4\\
            \hline
        \end{tabular}
    \end{center}
    Nous voudrions calculer la moyenne, la médiane et les quartiles de la distribution des tailles de chaussures. Nous allons nous occuper de cela dans les pages qui viennent.
\end{example}
    
    Pour calculer la moyenne d'une liste, nous devons savoir la longueur et la somme de ses éléments. Python fournit cela assez rapidement. Si \info{A} est une liste,
    \begin{enumerate}
        \item
            \info{len(A)} est la longueur de \info{A},
        \item
            \info{sum(A)} est la somme de ses éléments.
    \end{enumerate}
    
\Exo{Premiere-0035}
    
Le programme suivant écrit la moyenne de la liste des tailles de chaussures de l'exemple \ref{ExerfDMnv}.

\lstinputlisting{chaussures.py}

%\lstinputlisting{res_chaussures.txt}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Premier et troisième quartiles}
%---------------------------------------------------------------------------------------------------------------------------

Pour les quartiles, nous nous rappelons que si \( n\) est le nombre de valeurs, alors le rang du premier quartile est le premier entier supérieur à \( n/4\); et le rang du troisième quartile est le premier entier supérieur à \( 3n/4\). Par exemple si il y a \( 15\) données, nous calculons \( 3\times 15/3= 11.25\), et le troisième quartile sera la douzième valeur.


Bien entendu python possède une commande qui retourne le premier entier supérieur à un nombre donné. C'est la commande \info{ceil} du module \info{math}. En pratique :

\lstinputlisting{exemple_ceil.py}

donne 

\lstinputlisting{res_exemple_ceil.txt}
De même la fonction \info{math.floor} retourne le premier entier inférieur à un nombre donné. Par exemple \info{math.floor(3.89)} vaut \( 3\).

La ligne \info{import math} s'appelle «importer le module math», et nous n'en dirons sans doute pas plus sur la notion d'import de module. Le module \info{math} contient encore de nombreuses fonctions mathématiques qui transforment python en une très puissante\footnote{Pour donner une idée, la mémoire disponible sur des calculatrices modernes est à peu près la même que celle qui était disponible sur Apple II au début des années 1980; avec python vous pouvez exploiter toute la mémoire de votre ordinateur, ou de votre téléphone ou de votre tablette ou de quoi que ce soit sur lequel vous avez python.} calculatrice scientifique.


\Exo{Premiere-0036}

\lstinputlisting{premier_quartile.py}

Et voici pour la médiane :

\lstinputlisting{mediane.py}


\Exo{Premiere-0038}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{La boucle \info{for}}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Il est possible de répéter une action pour tous les éléments d'une liste. Par exemple

\lstinputlisting{ex_for1.py}

La première boucle écrit \info{x} et son carré pour tout \info{x} dans la liste \info{[1,5,10,2]}. La seconde boucle écrit tous les lettres du mot «bonjour» et la troisième tous les nombres dans \info{range(0,5)}, c'est à dire \( 0\), \( 1\), \( 2\), \( 3\) et \( 4\).

\lstinputlisting[title=Résultat]{res_ex_for1.txt}

\Exo{Premiere-0048}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Prendre des choses au hasard}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Python permet de tirer des nombres au hasard ou de prendre un élément au hasard dans une liste ou dans un texte. Pour cela il y a le module \info{random}. Si \info{A} est une liste ou un texte (chaîne de caractère), alors
\begin{quote}
    \info{random.choice(A)}
\end{quote}
retourne un élément au hasard de la suite.

\Exo{Premiere-0049}
\Exo{Premiere-0050}

\chapter{Suite définie par récurrence}

Soit une suite définie par récurrence

\begin{subequations}
    \begin{numcases}{}
    u_0=10\\
    u_{n+1}=2u_n.
    \end{numcases}
\end{subequations}

Nous voudrions pouvoir répondre à plusieurs types de questions :
\begin{enumerate}
    \item
        construire une liste contenant les \( 100\) premiers termes de la suite;
    \item
        savoir quel est le premier terme à dépasser un million.
    \item
        Quelle est l'allure générale de la suite ? Croissante ? Décroissante ?
\end{enumerate}

Avant de se lancer, nous devons nous poser une question de vocabulaire : est-ce que le centième terme de la suite \( u\) est \( u_{100}\) ou \( u_{99}\) ? Le premier terme étant \( u_0\), le centième est bien \( u_{99}\).


\Exo{Premiere-0056}

\lstinputlisting{recurrence1.py}

donne

\lstinputlisting{res_recurrence1.txt}

Notons que la ligne \info{print(u[100])} plante avec l'erreur \info{list index out of range}, c'est à dire que la liste \info{u} n'a pas d'élément \info{u[100]}, ce qui est normal parce qu'elle contient \( 100\) éléments et que la numérotation commence à zéro.


\Exo{Premiere-0039}


    En pratique, sachez que pour savoir le plus grand élément d'une liste, python dispose de la fonction \info{max}. Pour la suite, utilisez cette dernière, et non cette que vous aurez programmé dans cet exercice.


\Exo{Premiere-0057}

En ce qui concerne la possibilité de trouver le premier élément qui dépasse le million, le programme suivant donne une manière d'aborder le problème.

\lstinputlisting{recurrence2.py}

donne

\lstinputlisting{res_recurrence2.txt}

\Exo{Premiere-0058}

\begin{remark}
    
    Le code donné dans le programme \info{recurrence2.py} (cf. plus haut) donne \( 17\) et celui de l'exercice \ref{exoPremiere-0058} donne donne \( 18\). Qui a raison ? Le \( 18\) de la seconde méthode est la longueur de la liste construite, donc il indique que le premier terme à passer le million est \( u_{17}\) (vu que le premier terme est \( u_0\), la longueur est toujours un plus grande que le numéro du dernier élément).

La réponse est donc que \( u_{17}\) est le premier élément à être plus grand que un million, mais \( u_{17}\) est le dix-huitième élément de la liste.

\end{remark}

\Exo{Premiere-0055}

\chapter{Manipulation de texte}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Manipulation de base}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Pour mettre un texte dans une variable, il suffit de le faire :

\lstinputlisting{ex_texte1.py}
donne
\lstinputlisting[title=Résultat]{res_ex_texte1.txt}

Les chaînes de caractères (par exemple la variable \info{a} de l'exemple) peuvent être utilisées comme des listes. Il est possible d'en demander des parties.

\lstinputlisting{ex_texte2.py}
donne
\lstinputlisting[title=Résultat]{res_ex_texte2.txt}

La longueur d'un texte est donnée par \info{len(a)}.

Nous pouvons un peu automatiser :
\lstinputlisting{ex_texte3.py}
donne
\lstinputlisting[title=Résultat]{res_ex_texte3.txt}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Passer des textes au listes et inversement}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Si nous avons une suite de lettres, il est possible de la transformer en texte (chaîne de caractères), et inversement. Si \info{texte} est une chaîne de caractères, alors
\begin{quote}
    \info{list(A)}
\end{quote}
est la liste de ses caractères. La conversion dans ce sens est d'un intérêt limité parce que le gros des fonctionnalités des listes sont accessibles aux chaînes de caractères.

La conversion d'une liste en une chaîne est plus intéressante parce qu'elle permet de créer un texte «petit bout par petit bout». La méthode est la suivante. Si \info{A} est une liste alors
\begin{quote}
    \info{``''.join(A)}
\end{quote}
est la chaîne correspondante. Mieux : 
\begin{quote}
    \info{``-''.join(A)}
\end{quote}
est un texte qui «joint» les éléments de \info{A} par des tirets.

\lstinputlisting{ex_join1.py}

donne

\lstinputlisting[title=Résultat]{res_ex_join1.txt}


\Exo{Premiere-0051}

Il y a encore mieux. Il faut savoir que la chaîne \info{``\textbackslash n''} représente un saut de ligne. Par conséquent, en reliant les éléments d'une liste par un \info{``\textbackslash n''}, nous pouvons écrire les éléments en colonne. 

\lstinputlisting{ex_join2.py}

donne

\lstinputlisting[title=Résultat]{res_ex_join2.txt}

Et enfin, une dernière conversion consiste à séparer un texte en élément séparés par une chaîne. 

\lstinputlisting{ex_split1.py}

donne

\lstinputlisting[title=Résultat]{res_ex_split1.txt}


\Exo{Premiere-0052}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Un texte qui ressemble à du français}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

L'analyse de la fréquence des lettres dans un texte permet aussi de détecter la langue. Regardons ces trois textes, classés par ordre croissant de «crédibilité»:

\begin{quote}
    uuerlh i,ie oceieomriosnuu éctes 'qD umixnohpsnaedoteirinmrpouont nqenc a ltvpa n gcudttn  sercacuqe bu'iido retsaiacean sat oc leiu n  eéiteMe e   t  rtlteu rdédndame giaeosmx'raeaeea  jo m uds tum   et uaecetrûauu leel ttoœaxergs m'u aq uea un ileetid 'n utztotee isiranit aar,s evd e emlt zreumaganai nm,tlren id ouna,àadg lvnu s ai ie sut oqtrnœ u'nvtaoiemooe l  dqar meecésnc  jruscuttmse Aaasee ede netps  e riih
\end{quote}
Ce premier texte a été généré en prenant des lettres (y compris les espaces) au hasard dans un texte de référence\footnote{En l'occurence, \emph{Le temps retrouvé}.}. La fréquence des lettres est donc la même (aux aléas statistiques près) que la fréquence en français, mais force est d'avouer que cela ne ressemble pas tellement à du vrai français.
%TODO : mettre un lien vers wikisource pour le temps retrouvé
 
Second extrait :
\begin{quote}
    aiffe ditet ntta t cos rape uelloux sss éstére dile dsiten pen douitese Mmbis é ai quder ndises gau r qul aure à arsois arons à avese durcet l'Ountai vountel'aue i seuneueras e de beucene, la à qutout prmmontuxtri cet, rès ppllall anért me lle nte me s qujascoun c'œidisquss tintouvens me à nolllqut quiepomatrèraitra de meps fefr ll'ers'œusue suont de d ventistétapamer condes
\end{quote}
Cela est déjà un peu mieux. Notez en particulier la longueur des mots qui est plus raisonnable que dans le premier extrait. Voici comment il a été créé.
\begin{enumerate}
    \item
        La première lettre est tirée au hasard dans l'alphabet. Ici ça a été un «a».
    \item
        Nous cherchons tous les «a» dans le texte de référence, nous en prenons un au hasard, et nous ajoutons au texte la lettre \emph{qui suit}. Ici ça a été un «i». 
    \item
        Nous cherchons tous les «i» dans le texte de référence, etc.
\end{enumerate}
Cela explique pourquoi dans l'extrait donné, tous les «q» sont suivis d'un «u». En effet, dans le texte de référence presque tous les «q» sont suivis d'un «u». D'ailleurs, connaissez-vous un mot en français contenant un «q» non suivit d'un «u» ? Notez aussi qu'il y a six double «l», un seul double «m» et aucun double «e». Cela s'explique assez facilement en connaissant le français.

\begin{remark}
Dans le texte de référence, il y a des «q» non suivis de «u» dans les mots «piqûre», «coq», «cinq» (il est alors suivit d'un espace). La chaîne «qu» arrive 13528 fois dans le texte de référence et «q» suivit d'autre chose que «u» arrive seulement 24 fois.
\end{remark}

Troisième extrait :
\begin{quote}
Epgues vu un peut en m'avaisansfortes pour le dans que tout, cands ces cela comptableure amours dantestre ver aurais avaites, dont son de pours le simultés des planter, paysalutant évidue leux qu'ailles touffirer, ajour même un combianchez lui on de cholont décrir. Commette était même fortueux et de paru avait que jours pitait nulleurir cette le ce montions, nouvaien plaissé que sespèce souvoir connemi les gens ou resse solais ans mant ent, il du n'y a rançait au se dois « Alpe trientaient de Guer
\end{quote}
De loin, cela ressemble presque à s'y méprendre à du français, mais de près, on remarque que presque aucun mot n'est correct bien que tous les mots soient prononçables. Ce dernier extrait fut composé de la façon suivante.

\begin{enumerate}
    \item
        Choisir 3 lettres au hasard. Ici «epg» 
    \item
        Chercher tous les «epg» dans le texte de référence, et ajouter à l'extrait la lettre suivante. Ici c'est un «u» qui est ajouté.
    \item
        Chercher tous les «pgu» etc.
\end{enumerate}

Nous allons tenter de récrire un programme qui donne cet effet.


Un dernier pour la route. Exactement le même programme, mais en prenant un roman de Sherlock Holmes (en anglais) comme texte de référence.
\begin{quote}
dèWatseculiance is marked, at taken the unlikely siden would he placed man why Who becall wife you be othe for For to that the Amering raised. Thing his feely. "'Thand she sodes get wond infety. I said who which show will details. In see, and the Alic slansper, for stonvicturnia, and Lest but, 1892 "Shile, Petel. Then, and to man it und in my chan aframa. My litter gretaring me entagementyfound gent that, 1892 "Well days dramongroofs when some the looks upon pa weeks a reason a pipe of Penting wif
\end{quote}
Cela ressemble à de l'anglais sans aucun doute.

\Exo{Premiere-0053}
\Exo{Premiere-0054}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Exercices}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\Exo{Premiere-0027}
